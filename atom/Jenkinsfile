pipeline {
   agent any
   stages{
      stage('checkout'){
         steps{
            checkout scm
         }
      }
      stage('Build image') {
            when {
                changeset "atom/*"
            }
            steps {
                echo 'Building atom image, please wait ...'

                script {
                    withDockerRegistry([ credentialsId: "dockerhub", url: "" ]) {
                       def customImage = docker.build("xavibj/atom:${env.BUILD_ID}","-f atom/Dockerfile .")
                       def latest = docker.build("xavibj/atom:latest","-f atom/Dockerfile .")
                       customImage.push()
                       latest.push()
                    }
                }
            }
       }
   }
}
